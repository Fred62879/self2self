WARNING:tensorflow:From /home/fred862/env/astro_env/lib/python3.7/site-packages/tensorflow/python/compat/v2_compat.py:111: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
WARNING:tensorflow:From /home/fred862/env/astro_env/lib/python3.7/site-packages/tensorflow/python/util/dispatch.py:1096: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2022-07-08 13:58:10.899418: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-07-08 13:58:14.397134: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 10881 MB memory:  -> device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:04:00.0, compute capability: 6.0
2022-07-08 13:58:17.240215: I tensorflow/stream_executor/cuda/cuda_dnn.cc:366] Loaded cuDNN version 8200
2022-07-08 13:58:17.786219: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-07-08 13:58:17.791541: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-07-08 13:58:17.791723: W tensorflow/stream_executor/gpu/asm_compiler.cc:80] Couldn't get ptxas version string: INTERNAL: Couldn't invoke ptxas --version
2022-07-08 13:58:17.796608: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-07-08 13:58:17.796847: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] INTERNAL: Failed to launch ptxas
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
/scratch/fred862/fred862/code/astro/s2s/util.py:95: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  if loss == 'ssim': rd = 5
=== Parsing
--- output dir ../../../data/astro/pdr3_output/s2s_output/10/trail_7070/1_0_0.8
    load mask from ../../../data/astro/pdr3_input/sampled_pixl_ids/cutout_981316_512_0_0_mask_1_0_0_0/512_80.0.npy
    sampled pixls for full mask [262144, 262144, 262144, 262144, 262144, 262144, 262144, 209715, 262144, 209715]
[Iteration/Total]:[1/4000], [avg_loss]:[0.0205]
    Iteration 0, non zero mask 754287.0
    GT max [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    Recon pixl max  [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    mse [[0.   0.   0.   0.   0.   0.   0.   3.96 0.   0.21]]
    psnr [[147.25 144.78 149.8  151.22 153.6  138.78 156.78  49.95 141.61  47.33]]
    ssim [[1.   1.   1.   1.   1.   1.   1.   1.   1.   0.99]]
[Iteration/Total]:[400/4000], [avg_loss]:[8.3571]
    Iteration 399, non zero mask 755055.0
    GT max [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    Recon pixl max  [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    mse [[0.   0.   0.   0.   0.   0.   0.   3.89 0.   0.16]]
    psnr [[147.25 144.78 149.8  151.22 153.6  138.78 156.78  50.02 141.61  48.56]]
    ssim [[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]]
[Iteration/Total]:[800/4000], [avg_loss]:[8.3255]
    Iteration 799, non zero mask 755049.0
    GT max [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    Recon pixl max  [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    mse [[0.   0.   0.   0.   0.   0.   0.   3.89 0.   0.16]]
    psnr [[147.25 144.78 149.8  151.22 153.6  138.78 156.78  50.02 141.61  48.56]]
    ssim [[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]]
[Iteration/Total]:[1200/4000], [avg_loss]:[8.5012]
    Iteration 1199, non zero mask 754679.0
    GT max [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    Recon pixl max  [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    mse [[0.   0.   0.   0.   0.   0.   0.   3.89 0.   0.16]]
    psnr [[147.25 144.78 149.8  151.22 153.6  138.78 156.78  50.02 141.61  48.56]]
    ssim [[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]]
[Iteration/Total]:[1600/4000], [avg_loss]:[8.3805]
    Iteration 1599, non zero mask 755742.0
    GT max [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    Recon pixl max  [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    mse [[0.   0.   0.   0.   0.   0.   0.   3.89 0.   0.16]]
    psnr [[147.25 144.78 149.8  151.22 153.6  138.78 156.78  50.02 141.61  48.56]]
    ssim [[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]]
[Iteration/Total]:[2000/4000], [avg_loss]:[8.3153]
    Iteration 1999, non zero mask 755412.0
    GT max [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    Recon pixl max  [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    mse [[0.   0.   0.   0.   0.   0.   0.   3.89 0.   0.16]]
    psnr [[147.25 144.78 149.8  151.22 153.6  138.78 156.78  50.02 141.61  48.56]]
    ssim [[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]]
[Iteration/Total]:[2400/4000], [avg_loss]:[8.2291]
    Iteration 2399, non zero mask 755720.0
    GT max [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    Recon pixl max  [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    mse [[0.   0.   0.   0.   0.   0.   0.   3.89 0.   0.16]]
    psnr [[147.25 144.78 149.8  151.22 153.6  138.78 156.78  50.02 141.61  48.56]]
    ssim [[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]]
[Iteration/Total]:[2800/4000], [avg_loss]:[8.3218]
    Iteration 2799, non zero mask 756722.0
    GT max [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    Recon pixl max  [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    mse [[0.   0.   0.   0.   0.   0.   0.   3.89 0.   0.16]]
    psnr [[147.25 144.78 149.8  151.22 153.6  138.78 156.78  50.02 141.61  48.56]]
    ssim [[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]]
[Iteration/Total]:[3200/4000], [avg_loss]:[8.4780]
    Iteration 3199, non zero mask 754541.0
    GT max [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    Recon pixl max  [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    mse [[0.   0.   0.   0.   0.   0.   0.   3.89 0.   0.16]]
    psnr [[147.25 144.78 149.8  151.22 153.6  138.78 156.78  50.02 141.61  48.56]]
    ssim [[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]]
[Iteration/Total]:[3600/4000], [avg_loss]:[8.3762]
    Iteration 3599, non zero mask 754600.0
    GT max [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    Recon pixl max  [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    mse [[0.   0.   0.   0.   0.   0.   0.   3.89 0.   0.16]]
    psnr [[147.25 144.78 149.8  151.22 153.6  138.78 156.78  50.02 141.61  48.56]]
    ssim [[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]]
[Iteration/Total]:[4000/4000], [avg_loss]:[8.4478]
    Iteration 3999, non zero mask 755064.0
    GT max [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    Recon pixl max  [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    mse [[0.   0.   0.   0.   0.   0.   0.   3.89 0.   0.16]]
    psnr [[147.25 144.78 149.8  151.22 153.6  138.78 156.78  50.02 141.61  48.56]]
    ssim [[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]]
Timing  554.7328841686249
