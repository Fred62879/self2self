WARNING:tensorflow:From /home/fred862/env/astro_env/lib/python3.7/site-packages/tensorflow/python/compat/v2_compat.py:111: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
WARNING:tensorflow:From /home/fred862/env/astro_env/lib/python3.7/site-packages/tensorflow/python/util/dispatch.py:1096: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2022-07-08 13:58:08.400172: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-07-08 13:58:12.177238: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 10881 MB memory:  -> device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:04:00.0, compute capability: 6.0
2022-07-08 13:58:15.098930: I tensorflow/stream_executor/cuda/cuda_dnn.cc:366] Loaded cuDNN version 8200
2022-07-08 13:58:15.550191: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-07-08 13:58:15.553077: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-07-08 13:58:15.553234: W tensorflow/stream_executor/gpu/asm_compiler.cc:80] Couldn't get ptxas version string: INTERNAL: Couldn't invoke ptxas --version
2022-07-08 13:58:15.556327: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-07-08 13:58:15.556546: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] INTERNAL: Failed to launch ptxas
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
/scratch/fred862/fred862/code/astro/s2s/util.py:95: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  if loss == 'ssim': rd = 5
=== Parsing
--- output dir ../../../data/astro/pdr3_output/s2s_output/10/trail_7070/1_0_0.0001
    load mask from ../../../data/astro/pdr3_input/sampled_pixl_ids/cutout_981316_512_0_0_mask_1_0_0_0/512_0.01.npy
    sampled pixls for full mask [262144, 262144, 262144, 262144, 262144, 262144, 262144, 26, 262144, 26]
[Iteration/Total]:[1/4000], [avg_loss]:[0.0201]
    Iteration 0, non zero mask 630303.0
    GT max [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    Recon pixl max  [230.33 173.33 309.11 363.86 478.88  86.91 690.09   1.   120.32   1.  ]
    mse [[ 0.    0.    0.    0.    0.    0.    0.   19.13  0.    0.96]]
    psnr [[147.25 144.78 149.8  151.22 153.6  138.78 156.78  43.11 141.61  40.77]]
    ssim [[1.   1.   1.   1.   1.   1.   1.   0.01 1.   0.01]]
[Iteration/Total]:[400/4000], [avg_loss]:[8.1506]
    Iteration 399, non zero mask 627641.0
    GT max [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    Recon pixl max  [230.33 173.33 309.11 363.86 478.88  86.91 690.09   1.   120.32   1.  ]
    mse [[ 0.   0.   0.   0.   0.   0.   0.  18.8  0.   0.7]]
    psnr [[147.25 144.78 149.8  151.22 153.6  138.78 156.78  43.18 141.61  42.13]]
    ssim [[1.   1.   1.   1.   1.   1.   1.   0.2  1.   0.65]]
[Iteration/Total]:[800/4000], [avg_loss]:[8.1157]
    Iteration 799, non zero mask 628443.0
    GT max [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    Recon pixl max  [230.33 173.33 309.11 363.86 478.88  86.91 690.09   1.   120.32   1.  ]
    mse [[ 0.   0.   0.   0.   0.   0.   0.  18.8  0.   0.7]]
    psnr [[147.25 144.78 149.8  151.22 153.6  138.78 156.78  43.18 141.61  42.13]]
    ssim [[1.   1.   1.   1.   1.   1.   1.   0.21 1.   0.68]]
[Iteration/Total]:[1200/4000], [avg_loss]:[8.1282]
    Iteration 1199, non zero mask 628878.0
    GT max [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    Recon pixl max  [230.33 173.33 309.11 363.86 478.88  86.91 690.09   1.   120.32   1.  ]
    mse [[ 0.   0.   0.   0.   0.   0.   0.  18.8  0.   0.7]]
    psnr [[147.25 144.78 149.8  151.22 153.6  138.78 156.78  43.18 141.61  42.13]]
    ssim [[1.   1.   1.   1.   1.   1.   1.   0.21 1.   0.68]]
[Iteration/Total]:[1600/4000], [avg_loss]:[8.0920]
    Iteration 1599, non zero mask 629576.0
    GT max [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    Recon pixl max  [230.33 173.33 309.11 363.86 478.88  86.91 690.09   1.   120.32   1.  ]
    mse [[ 0.   0.   0.   0.   0.   0.   0.  18.8  0.   0.7]]
    psnr [[147.25 144.78 149.8  151.22 153.6  138.78 156.78  43.18 141.61  42.13]]
    ssim [[1.   1.   1.   1.   1.   1.   1.   0.21 1.   0.68]]
[Iteration/Total]:[2000/4000], [avg_loss]:[8.0969]
    Iteration 1999, non zero mask 629493.0
    GT max [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    Recon pixl max  [230.33 173.33 309.11 363.86 478.88  86.91 690.09   1.   120.32   1.  ]
    mse [[ 0.   0.   0.   0.   0.   0.   0.  18.8  0.   0.7]]
    psnr [[147.25 144.78 149.8  151.22 153.6  138.78 156.78  43.18 141.61  42.13]]
    ssim [[1.   1.   1.   1.   1.   1.   1.   0.22 1.   0.7 ]]
[Iteration/Total]:[2400/4000], [avg_loss]:[8.0835]
    Iteration 2399, non zero mask 628625.0
    GT max [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    Recon pixl max  [230.33 173.33 309.11 363.86 478.88  86.91 690.09   1.   120.32   1.  ]
    mse [[ 0.   0.   0.   0.   0.   0.   0.  18.8  0.   0.7]]
    psnr [[147.25 144.78 149.8  151.22 153.6  138.78 156.78  43.18 141.61  42.13]]
    ssim [[1.   1.   1.   1.   1.   1.   1.   0.21 1.   0.7 ]]
[Iteration/Total]:[2800/4000], [avg_loss]:[8.1191]
    Iteration 2799, non zero mask 629016.0
    GT max [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    Recon pixl max  [230.33 173.33 309.11 363.86 478.88  86.91 690.09   1.   120.32   1.  ]
    mse [[ 0.   0.   0.   0.   0.   0.   0.  18.8  0.   0.7]]
    psnr [[147.25 144.78 149.8  151.22 153.6  138.78 156.78  43.18 141.61  42.13]]
    ssim [[1.   1.   1.   1.   1.   1.   1.   0.21 1.   0.72]]
[Iteration/Total]:[3200/4000], [avg_loss]:[8.1753]
    Iteration 3199, non zero mask 629815.0
    GT max [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    Recon pixl max  [230.33 173.33 309.11 363.86 478.88  86.91 690.09   1.   120.32   1.  ]
    mse [[ 0.   0.   0.   0.   0.   0.   0.  18.8  0.   0.7]]
    psnr [[147.25 144.78 149.8  151.22 153.6  138.78 156.78  43.18 141.61  42.13]]
    ssim [[1.   1.   1.   1.   1.   1.   1.   0.21 1.   0.73]]
[Iteration/Total]:[3600/4000], [avg_loss]:[7.9890]
    Iteration 3599, non zero mask 629389.0
    GT max [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    Recon pixl max  [230.33 173.33 309.11 363.86 478.88  86.91 690.09   1.   120.32   1.  ]
    mse [[ 0.   0.   0.   0.   0.   0.   0.  18.8  0.   0.7]]
    psnr [[147.25 144.78 149.8  151.22 153.6  138.78 156.78  43.18 141.61  42.13]]
    ssim [[1.   1.   1.   1.   1.   1.   1.   0.21 1.   0.74]]
[Iteration/Total]:[4000/4000], [avg_loss]:[8.1027]
    Iteration 3999, non zero mask 628476.0
    GT max [230.33 173.33 309.11 363.86 478.88  86.91 690.09 625.65 120.32 106.8 ]
    Recon pixl max  [230.33 173.33 309.11 363.86 478.88  86.91 690.09   1.   120.32   1.  ]
    mse [[ 0.   0.   0.   0.   0.   0.   0.  18.8  0.   0.7]]
    psnr [[147.25 144.78 149.8  151.22 153.6  138.78 156.78  43.18 141.61  42.13]]
    ssim [[1.   1.   1.   1.   1.   1.   1.   0.21 1.   0.73]]
Timing  553.4996774196625
